<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="PhishGuard — Real-Time Phishing URL Detection powered by Machine Learning and SHAP Explainability" />
  <title>PhishGuard — Real-Time Phishing Detection</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="css/style.css" />
  <script>window.PHISHGUARD_API_BASE = 'http://localhost:8000';</script>
</head>
<body>

<!-- Scroll progress -->
<div id="scroll-progress"><div id="scroll-bar"></div></div>

<!-- Particle Background -->
<canvas id="particle-canvas"></canvas>

<!-- Aurora Background -->
<div class="aurora" aria-hidden="true">
  <div class="aurora-band aurora-band-1"></div>
  <div class="aurora-band aurora-band-2"></div>
  <div class="aurora-band aurora-band-3"></div>
</div>

<!-- Toast notification area -->
<div id="toast-container" aria-live="polite"></div>

<div class="app-wrapper">

  <!-- ═══ Header ═════════════════════════════════════════════════════════ -->
  <header class="header" id="main-header">
    <a class="logo" href="#">
      <div class="logo-icon">&#128737;</div>
      <div>
        <div class="logo-text glitch" data-text="PHISHGUARD">PHISHGUARD</div>
        <div class="logo-tagline">Real-Time Threat Detection</div>
      </div>
    </a>

    <nav class="header-nav">
      <div class="session-counter" title="URLs scanned this session">
        <span class="session-icon">&#9881;</span>
        <span id="session-count">0</span>
        <span class="session-label">scans</span>
      </div>

      <div class="header-status">
        <span class="status-dot"></span>
        <span id="status-text">INITIALIZING...</span>
      </div>

      <button class="icon-btn" id="kbd-hints-btn" title="Keyboard Shortcuts" aria-label="Keyboard shortcuts">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" width="16" height="16">
          <rect x="2" y="6" width="20" height="13" rx="2"/>
          <path d="M6 10h.01M10 10h.01M14 10h.01M18 10h.01M8 14h8"/>
        </svg>
      </button>
    </nav>
  </header>


  <!-- ═══ Hero ════════════════════════════════════════════════════════════ -->
  <section class="hero reveal" data-parallax="0.25">
    <div class="hero-badge">
      <span class="badge-dot"></span>
      <span>AI-Powered Phishing Intelligence</span>
    </div>
    <h1 class="hero-title">
      Detect <span class="gradient-text gradient-text-anim">Phishing URLs</span><br/>In Real-Time
    </h1>
    <p class="hero-subtitle">
      <span id="typewriter"></span><span class="typewriter-cursor">|</span>
    </p>

    <div class="hero-stats">
      <div class="stat-item reveal-delay-1">
        <div class="stat-value counter" data-target="90">0</div>
        <div class="stat-suffix">%+</div>
        <div class="stat-label">F1 Score</div>
      </div>
      <div class="stat-divider"></div>
      <div class="stat-item reveal-delay-2">
        <div class="stat-value">&lt;1</div>
        <div class="stat-suffix">s</div>
        <div class="stat-label">Response Time</div>
      </div>
      <div class="stat-divider"></div>
      <div class="stat-item reveal-delay-3">
        <div class="stat-value counter" data-target="28">0</div>
        <div class="stat-suffix">+</div>
        <div class="stat-label">Feature Signals</div>
      </div>
      <div class="stat-divider"></div>
      <div class="stat-item reveal-delay-4">
        <div class="stat-value">SHAP</div>
        <div class="stat-suffix"></div>
        <div class="stat-label">Explainability</div>
      </div>
    </div>
  </section>


  <!-- ═══ How It Works ════════════════════════════════════════════════════ -->
  <section class="how-it-works reveal">
    <div class="section-label">How It Works</div>
    <div class="how-steps">
      <div class="how-step reveal-delay-1 tilt-card">
        <div class="step-num">01</div>
        <div class="step-icon">&#128279;</div>
        <div class="step-title">URL Input</div>
        <div class="step-desc">Paste any URL — shortened links, IP-based, or suspicious domains</div>
      </div>
      <div class="step-connector"></div>
      <div class="how-step reveal-delay-2 tilt-card">
        <div class="step-num">02</div>
        <div class="step-icon">&#9881;</div>
        <div class="step-title">Feature Extraction</div>
        <div class="step-desc">28+ lexical &amp; domain features extracted in milliseconds</div>
      </div>
      <div class="step-connector"></div>
      <div class="how-step reveal-delay-3 tilt-card">
        <div class="step-num">03</div>
        <div class="step-icon">&#129504;</div>
        <div class="step-title">ML Classification</div>
        <div class="step-desc">XGBoost / Random Forest model scores phishing probability</div>
      </div>
      <div class="step-connector"></div>
      <div class="how-step reveal-delay-4 tilt-card">
        <div class="step-num">04</div>
        <div class="step-icon">&#128202;</div>
        <div class="step-title">SHAP Explanation</div>
        <div class="step-desc">Transparent AI explains exactly why a URL is flagged</div>
      </div>
    </div>
  </section>


  <!-- ═══ Scanner Input ═══════════════════════════════════════════════════ -->
  <section class="scanner-section reveal" id="scanner">
    <div class="section-label">URL Target Scanner</div>

    <!-- Scan mode tabs -->
    <div class="scan-mode-tabs">
      <button class="mode-tab active" id="tab-single" data-mode="single">Single URL</button>
      <button class="mode-tab" id="tab-batch" data-mode="batch">Batch Scan</button>
      <button class="mode-tab upload-tab" id="tab-upload" data-mode="upload">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="13" height="13" style="margin-right:4px;vertical-align:middle"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
        File Upload
      </button>
    </div>

    <!-- Single URL mode -->
    <div id="mode-single">
      <div class="input-group">
        <div class="url-input-wrapper">
          <span class="url-input-icon">&#128279;</span>
          <input
            id="url-input"
            class="url-input"
            type="text"
            placeholder="https://suspicious-site.example.com/login?redirect=paypal"
            autocomplete="off"
            spellcheck="false"
          />
          <button class="input-clear-btn" id="clear-input-btn" title="Clear" aria-label="Clear input">&#10005;</button>
        </div>

        <button id="scan-btn" class="scan-btn ripple-btn" aria-label="Scan URL">
          <span class="scan-btn-spinner"></span>
          <span class="scan-btn-icon">&#9889;</span>
          <span class="btn-text">SCAN</span>
        </button>
      </div>
    </div>

    <!-- Batch URL mode -->
    <div id="mode-batch" class="hidden">
      <textarea
        id="batch-input"
        class="batch-textarea"
        placeholder="Paste one URL per line (max 10)&#10;https://example1.com&#10;http://suspicious-site.xyz/login&#10;..."
        rows="5"
      ></textarea>
      <button id="batch-scan-btn" class="scan-btn ripple-btn" style="margin-top:12px;">
        <span class="scan-btn-spinner"></span>
        <span class="scan-btn-icon">&#9889;</span>
        <span class="btn-text">SCAN ALL</span>
      </button>
      <div id="batch-results" class="batch-results hidden"></div>
    </div>

    <!-- File Upload mode -->
    <div id="mode-upload" class="hidden">
      <div id="upload-zone" class="upload-zone" role="button" tabindex="0" aria-label="Upload file">
        <input type="file" id="upload-file-input" accept=".txt,.csv" style="display:none" />
        <div class="upload-zone-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="48" height="48">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M16 11l-4-4-4 4M12 7v9"/>
          </svg>
        </div>
        <div class="upload-zone-title">Drop your file here</div>
        <div class="upload-zone-sub">or <span class="upload-zone-link">click to browse</span></div>
        <div class="upload-zone-hint">
          <span class="upload-badge">.txt</span>
          <span class="upload-badge">.csv</span>
          &nbsp;· up to 500 URLs · max 5 MB
        </div>
      </div>

      <!-- selected file info -->
      <div id="upload-file-info" class="upload-file-info hidden">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
        <span id="upload-filename" class="mono"></span>
        <span id="upload-filesize" class="upload-filesize"></span>
        <button id="upload-clear-btn" class="upload-clear-btn" title="Remove file">&#10005;</button>
      </div>

      <!-- progress bar -->
      <div id="upload-progress-wrap" class="upload-progress-wrap hidden">
        <div class="upload-progress-header">
          <span id="upload-progress-label" class="mono" style="font-size:12px;color:var(--text-secondary)">Scanning…</span>
          <span id="upload-progress-pct" class="mono" style="font-size:12px;color:var(--neon-cyan)">0%</span>
        </div>
        <div class="upload-progress-track">
          <div id="upload-progress-bar" class="upload-progress-bar"></div>
        </div>
      </div>

      <!-- summary stats -->
      <div id="upload-summary" class="upload-summary hidden">
        <div class="upload-stat-card upload-stat-total">
          <div class="upload-stat-num" id="us-total">0</div>
          <div class="upload-stat-lbl">Total</div>
        </div>
        <div class="upload-stat-card upload-stat-phish">
          <div class="upload-stat-num" id="us-phishing">0</div>
          <div class="upload-stat-lbl">Phishing</div>
        </div>
        <div class="upload-stat-card upload-stat-susp">
          <div class="upload-stat-num" id="us-suspicious">0</div>
          <div class="upload-stat-lbl">Suspicious</div>
        </div>
        <div class="upload-stat-card upload-stat-safe">
          <div class="upload-stat-num" id="us-safe">0</div>
          <div class="upload-stat-lbl">Safe</div>
        </div>
      </div>

      <!-- results table -->
      <div id="upload-results" class="upload-results hidden">
        <div class="upload-results-header">
          <span id="upload-results-count" class="mono" style="font-size:12px;color:var(--text-secondary)"></span>
          <button id="upload-export-btn" class="ghost-btn" style="font-size:11px;">Export CSV</button>
        </div>
        <div class="upload-table-wrap">
          <table class="upload-table">
            <thead>
              <tr>
                <th>#</th>
                <th>URL</th>
                <th>Verdict</th>
                <th>Risk</th>
                <th>Confidence</th>
              </tr>
            </thead>
            <tbody id="upload-tbody"></tbody>
          </table>
        </div>
      </div>

      <button id="upload-scan-btn" class="scan-btn ripple-btn hidden" style="margin-top:12px;">
        <span class="scan-btn-spinner"></span>
        <span class="scan-btn-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        </span>
        <span class="btn-text">SCAN FILE</span>
      </button>
    </div>

    <!-- Options row -->
    <div class="scan-options" id="scan-options-row">
      <label class="toggle-label">
        <input id="domain-toggle" type="checkbox" />
        <span class="toggle-switch"></span>
        Deep Scan (WHOIS + SSL)
      </label>

      <div class="kbd-hint">
        <kbd>Enter</kbd> to scan &nbsp;·&nbsp; <kbd>Esc</kbd> to clear
      </div>

      <div class="example-urls">
        <span class="example-label">Try:</span>
        <span class="example-chip" data-url="https://google.com">google.com</span>
        <span class="example-chip" data-url="http://paypa1-secure-login.xyz/verify?user=admin">paypa1 phish</span>
        <span class="example-chip" data-url="http://192.168.1.1/login?redirect=bankofamerica.com">IP phish</span>
        <span class="example-chip" data-url="https://bit.ly/3phishurl">short URL</span>
      </div>
    </div>

    <!-- Error Banner -->
    <div id="error-banner" class="error-banner" role="alert" aria-live="polite"></div>

    <!-- Scan Progress -->
    <div id="scan-progress" class="scan-progress">
      <div class="progress-stages">
        <div id="stage-extract" class="stage-item pending" data-icon="○">
          <div class="stage-icon">○</div>
          <div class="stage-text">Extracting URL features...</div>
          <div class="stage-spinner"></div>
        </div>
        <div id="stage-model" class="stage-item pending" data-icon="○">
          <div class="stage-icon">○</div>
          <div class="stage-text">Running ML classifier...</div>
          <div class="stage-spinner"></div>
        </div>
        <div id="stage-shap" class="stage-item pending" data-icon="○">
          <div class="stage-icon">○</div>
          <div class="stage-text">Computing SHAP values...</div>
          <div class="stage-spinner"></div>
        </div>
        <div id="stage-score" class="stage-item pending" data-icon="○">
          <div class="stage-icon">○</div>
          <div class="stage-text">Generating risk score...</div>
          <div class="stage-spinner"></div>
        </div>
      </div>
    </div>
  </section>


  <!-- ═══ Results Panel ═══════════════════════════════════════════════════ -->
  <div id="results-panel" role="region" aria-label="Analysis Results">

    <!-- ─── Left: Verdict Card ─────────────────────────────────────── -->
    <div id="verdict-card" class="verdict-card tilt-card">

      <!-- Risk Gauge -->
      <div class="risk-gauge-container" aria-label="Risk Score Gauge">
        <svg class="risk-gauge-svg" viewBox="0 0 200 200">
          <defs>
            <filter id="glow">
              <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
              <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <circle class="gauge-bg" cx="100" cy="100" r="80" />
          <circle id="gauge-fill" class="gauge-fill" cx="100" cy="100" r="80" filter="url(#glow)" />
        </svg>
        <div class="gauge-center-content">
          <div id="risk-score-number" class="risk-score-number">0</div>
          <div class="risk-score-label">Risk Score</div>
        </div>
      </div>

      <!-- Verdict Badge -->
      <div id="verdict-badge" class="verdict-badge legitimate">
        <span id="verdict-icon" class="verdict-icon">&#128269;</span>
        <span id="verdict-text">Scanning...</span>
      </div>

      <!-- Confidence Bar -->
      <div class="confidence-section">
        <div class="confidence-header">
          <span>Confidence</span>
          <span id="confidence-val" class="confidence-value">—</span>
        </div>
        <div class="bar-track">
          <div id="confidence-bar" class="bar-fill legitimate" style="width:0%"></div>
        </div>
      </div>

      <!-- Meta Info -->
      <div class="verdict-meta">
        <div class="meta-row">
          <span class="meta-key">Model</span>
          <span class="meta-val" id="model-used">—</span>
        </div>
        <div class="meta-row">
          <span class="meta-key">Latency</span>
          <span class="meta-val" id="latency-val">—</span>
        </div>
        <div class="meta-row">
          <span class="meta-key">Scanned</span>
          <span class="meta-val" id="timestamp-val">—</span>
        </div>
      </div>

      <!-- Actions -->
      <div class="verdict-actions">
        <button class="action-btn ripple-btn" id="export-btn" title="Export report as JSON">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          Export JSON
        </button>
        <button class="action-btn ripple-btn" id="copy-result-btn" title="Copy result summary">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
          Copy
        </button>
      </div>
    </div>

    <!-- ─── Right: Details Panel ───────────────────────────────────── -->
    <div class="details-panel">

      <!-- URL Breakdown -->
      <div class="detail-card tilt-card">
        <div class="card-title">
          <span>&#128279; URL Breakdown</span>
          <button class="card-action-btn" id="copy-url-btn" title="Copy URL">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
            Copy URL
          </button>
        </div>
        <div id="url-display" class="url-display">—</div>
        <div id="url-parts" class="url-parts"></div>
      </div>

      <!-- Threat Indicators Grid -->
      <div class="detail-card tilt-card">
        <div class="card-title">&#128737; Threat Indicators</div>
        <div id="threat-grid" class="threat-grid"></div>
      </div>

      <!-- SHAP Explanations -->
      <div class="detail-card tilt-card">
        <div class="card-title">&#129504; AI Explanation (SHAP)</div>
        <div id="explanations-list" class="explanations-list">
          <div class="explanation-item safe">
            <span class="exp-icon">&#128269;</span>
            <span>Awaiting analysis...</span>
          </div>
        </div>
      </div>

      <!-- Feature Importance -->
      <div class="detail-card tilt-card">
        <div class="card-title">&#128202; Top Feature Signals</div>
        <div id="feature-bars" class="feature-bars">
          <div style="color:var(--text-muted);font-size:13px;">Awaiting analysis...</div>
        </div>
      </div>

    </div>
  </div>


  <!-- ═══ Scan History ════════════════════════════════════════════════════ -->
  <section id="history-section" class="history-section reveal" aria-label="Scan History">
    <div class="section-label-row">
      <div class="section-label" style="margin-bottom:0;">Scan History</div>
      <button class="ghost-btn" id="clear-history-btn">Clear All</button>
    </div>
    <div class="history-table-wrapper">
      <table class="history-table" role="table">
        <thead>
          <tr>
            <th>URL</th>
            <th>Verdict</th>
            <th>Risk</th>
            <th>Confidence</th>
            <th>Time</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="history-body"></tbody>
      </table>
    </div>
  </section>


  <!-- ═══ Capabilities Strip ══════════════════════════════════════════════ -->
  <section class="capabilities-strip reveal">
    <div class="cap-item">
      <div class="cap-icon">&#128737;</div>
      <div class="cap-text">Brand Spoofing Detection</div>
    </div>
    <div class="cap-item">
      <div class="cap-icon">&#127760;</div>
      <div class="cap-text">IP-in-URL Analysis</div>
    </div>
    <div class="cap-item">
      <div class="cap-icon">&#128274;</div>
      <div class="cap-text">SSL Certificate Check</div>
    </div>
    <div class="cap-item">
      <div class="cap-icon">&#128202;</div>
      <div class="cap-text">SHAP Explainability</div>
    </div>
    <div class="cap-item">
      <div class="cap-icon">&#9889;</div>
      <div class="cap-text">Sub-second Inference</div>
    </div>
    <div class="cap-item">
      <div class="cap-icon">&#128196;</div>
      <div class="cap-text">File Batch Upload</div>
    </div>
  </section>


  <!-- ═══ Footer ══════════════════════════════════════════════════════════ -->
  <footer class="footer">
    <div class="footer-brand mono">PhishGuard v1.0 &mdash; Real-Time Phishing Detection</div>
    <nav class="footer-links" aria-label="Footer links">
      <a href="/docs" target="_blank" rel="noopener">API Docs</a>
      <a href="/redoc" target="_blank" rel="noopener">ReDoc</a>
      <a href="/health" target="_blank" rel="noopener">Health</a>
      <a href="#" id="footer-clear-history">Clear History</a>
    </nav>
  </footer>

</div><!-- /app-wrapper -->


<!-- Keyboard Shortcuts Modal -->
<div id="kbd-modal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-label="Keyboard shortcuts">
  <div class="modal-box">
    <div class="modal-header">
      <span class="mono" style="color:var(--neon-cyan);font-size:13px;letter-spacing:2px;">KEYBOARD SHORTCUTS</span>
      <button class="modal-close" id="kbd-modal-close">&#10005;</button>
    </div>
    <div class="modal-body">
      <div class="kbd-row"><kbd>/</kbd> <span>Focus URL input</span></div>
      <div class="kbd-row"><kbd>Enter</kbd> <span>Scan URL</span></div>
      <div class="kbd-row"><kbd>Esc</kbd> <span>Clear input</span></div>
      <div class="kbd-row"><kbd>Ctrl</kbd>+<kbd>E</kbd> <span>Export last result as JSON</span></div>
      <div class="kbd-row"><kbd>Ctrl</kbd>+<kbd>/</kbd> <span>Open this shortcuts panel</span></div>
    </div>
  </div>
</div>

<script src="js/app.js"></script>
</body>
</html>
